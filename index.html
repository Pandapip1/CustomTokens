<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

        <title>Create your ERC20 token</title>
        <!-- color scheme https://coolors.co/0d0630-18314f-384e77-8bbeb2-e6f9af -->
    </head>
    <body style="background-color: #0D0630;">
        <div class="w-100 h-100" id="app">
            <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);" class="w-75">
                <div class="card mb-3 w-100 h-100 bg-white text-dark p-3">
                    <div class="col-md-auto text-black">
                        <div class="d-flex align-items-start">
                            <div class="nav flex-column nav-pills me-3" id="v-pills-tab" role="tablist" aria-orientation="vertical">
                                <button class="nav-link active" id="v-pills-meta-tab" data-bs-toggle="pill" data-bs-target="#v-pills-meta" type="button" role="tab" aria-controls="v-pills-meta" aria-selected="true" v-bind:disabled="deploymentStep != 0" v-bind:class="{ disabled: deploymentStep != 0 }">Metadata</button>
                                <button class="nav-link" id="v-pills-redist-tab" data-bs-toggle="pill" data-bs-target="#v-pills-redist" type="button" role="tab" aria-controls="v-pills-redist" aria-selected="false" v-bind:disabled="!token.meta.symbol || !token.meta.name || deploymentStep != 0" v-bind:class="{ disabled: !token.meta.symbol || !token.meta.name || deploymentStep != 0 }">Redistribution</button>
                                <button class="nav-link" id="v-pills-supply-tab" data-bs-toggle="pill" data-bs-target="#v-pills-supply" type="button" role="tab" aria-controls="v-pills-supply" aria-selected="false" v-bind:disabled="!token.meta.symbol || !token.meta.name || deploymentStep != 0" v-bind:class="{ disabled: !token.meta.symbol || !token.meta.name || deploymentStep != 0 }">Initial Supply</button>
                                <button class="nav-link" id="v-pills-deploy-tab" data-bs-toggle="pill" data-bs-target="#v-pills-deploy" type="button" role="tab" aria-controls="v-pills-deploy" aria-selected="false" v-bind:disabled="!token.meta.symbol || !token.meta.name || !token.supply.length" v-bind:class="{ disabled: !token.meta.symbol || !token.meta.name || !token.supply.length }">Deploy</button>
                            </div>
                            <div class="tab-content w-100" id="v-pills-tabContent">
                                <div class="tab-pane fade show active" id="v-pills-meta" role="tabpanel" aria-labelledby="v-pills-meta-tab">
                                    <div class="input-group">
                                        <input type="text" aria-label="Name" class="form-control" placeholder="Name (e.g. My Epic Token)" v-model="token.meta.name">
                                        <input type="text" aria-label="Symbol" class="form-control" placeholder="Symbol (e.g MYTOKEN)" v-model="token.meta.symbol">
                                        <input type="text" aria-label="Decimals" class="form-control" readonly value="18">
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="v-pills-redist" role="tabpanel" aria-labelledby="v-pills-redist-tab">
                                    <label for="feeRange" class="form-label">Fee: {{ token.redist.fee }}%</label>
                                    <input type="range" class="form-range" min="0" max="15" step="0.5" id="feeRange" v-model="token.redist.fee">
                                    <div v-if="token.redist.fee != 0">
                                        <hr/>
                                        <label for="burnRange" class="form-label">Burn: {{ 100 - token.redist.addresses.reduce((previousValue, item) => (previousValue + item.amt), 0) - token.redist.holder }}%</label>
                                        <input type="range" class="form-range disabled" min="0" max="100" step="0.1" id="burnRange" v-bind:value="100 - token.redist.addresses.reduce((previousValue, item) => (previousValue + item.amt), 0) - token.redist.holder" disabled>
                                        <label for="holdRange" class="form-label">Holder Redistribution: {{ token.redist.holder }}%</label>
                                        <input type="range" class="form-range" min="0" max="100" step="0.1" id="holdRange" v-model="token.redist.holder" readonly>
                                        <div class="row" v-for="(item, index) in token.redist.addresses">
                                            <div class="col" style="vertical-align: middle;">
                                                {{ token.redist.addresses[index].addr }}
                                            </div>
                                            <div class="col-md-auto" style="vertical-align: middle;">
                                                {{ token.redist.addresses[index].amt }}%
                                            </div>
                                            <div class="col-md-auto" style="vertical-align: middle;">
                                                <a href="#" v-on:click="token.redist.addresses.splice(index, 1)">Remove</a>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-12">
                                                <div class="input-group">
                                                    <input type="text" class="form-control" v-model="token.redist.temp.addr" placeholder="Ethereum Address (0x000...)">
                                                    <input type="number" class="form-control" v-model="token.redist.temp.amt" placeholder="Redistribution Percent (e.g. 5)">
                                                    <span class="input-group-text">%</span>
                                                    <button class="btn btn-outline-primary" v-on:click="token.redist.addresses.push({ addr: token.redist.temp.addr, amt: token.redist.temp.amt })">Add</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-check" v-if="100 != token.redist.addresses.reduce((previousValue, item) => (previousValue + item.amt), 0) + token.redist.holder">
                                            <br/>
                                            <input class="form-check-input" type="checkbox" id="supportDev" v-model="token.redist.supdev">
                                            <label class="form-check-label" for="supportDev">
                                                Support <a href="https://github.com/Pandapip1" target="_blank">the developer</a> with 0.5% of the amount that would usually be burnt
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="v-pills-supply" role="tabpanel" aria-labelledby="v-pills-supply-tab">
                                    <div class="row" v-for="(item, index) in token.supply">
                                        <div class="col" style="vertical-align: middle;">
                                            {{ token.supply[index].addr }}
                                        </div>
                                        <div class="col-md-auto" style="vertical-align: middle;">
                                            {{ token.supply[index].amt }}%
                                        </div>
                                        <div class="col-md-auto" style="vertical-align: middle;">
                                            <a href="#" v-on:click="token.supply.splice(index, 1)">Remove</a>
                                        </div>
                                    </div>
                                    <div class="input-group">
                                        <input type="text" class="form-control" v-model="token.tempSupply.addr" placeholder="Ethereum Address (0x000...)">
                                        <input type="number" class="form-control" v-model="token.tempSupply.amt" placeholder="Initial Supply (e.g. 100000)">
                                        <span class="input-group-text">{{ token.meta.symbol }}</span>
                                        <button class="btn btn-outline-primary" v-on:click="token.supply.push({ addr: token.tempSupply.addr, amt: token.tempSupply.amt })">Add</button>
                                    </div>
                                </div>
                                <div class="tab-pane fade show active" id="v-pills-deploy" role="tabpanel" aria-labelledby="v-pills-deploy-tab">
                                    <div class="progress" v-if="deploymentStep != 0">
                                        <div class="progress-bar" role="progressbar" v-bind:aria-valuenow="deploymentStep" v-bind:style="{ width: `${deploymentStep * 4}%` }" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                    <button v-on:click="deploy" class="btn btn-primary" v-bind:class="{ disabled: deploymentStep != 0 }" type="button" v-bind:disabled="deploymentStep != 0">
                                        <span v-if="deploymentStep != 0" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                                        <span v-if="deploymentStep != 0">Deploying...</span>
                                        <span v-if="deploymentStep == 0">Deploy</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" crossorigin="anonymous"></script>
        <script src="https://unpkg.com/vue@3" crossorigin="anonymous"></script>
        <script>
            window.onerror = (message, source, lineno, colno, error) => {
                alert(`Message: ${message}\nSource: ${source} at ${lineno}:${colno}`);
            };

            const { createApp } = Vue;
          
            let app = createApp({
                data() {
                    return {
                        token: {
                            meta: {
                                name: "",
                                symbol: ""
                            },
                            redist: {
                                holder: 0,
                                addresses: [],
                                fee: 0,
                                supdev: true,
                                temp: {
                                    amt: 0,
                                    addr: ""
                                }
                            },
                            supply: [],
                            tempSupply: {
                                amt: 0,
                                addr: ""
                            }
                        },
                        deploymentStep: 0
                    }
                }, methods: {
                    async deploy(event) {
                        this.deploymentStep = 1;
                    }
                }
            });

            app.mount('#app');
        </script>
    </body>
</html>